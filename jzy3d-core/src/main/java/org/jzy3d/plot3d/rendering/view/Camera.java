package org.jzy3d.plot3d.rendering.view;

import java.util.ArrayList;
import java.util.List;
import java.util.Vector;
import java.util.function.Predicate;
import org.apache.log4j.Logger;
import org.jzy3d.colors.Color;
import org.jzy3d.maths.Coord3d;
import org.jzy3d.maths.PolygonArray;
import org.jzy3d.painters.IPainter;
import org.jzy3d.plot3d.primitives.Drawable;
import org.jzy3d.plot3d.rendering.view.modes.CameraMode;
import org.jzy3d.plot3d.transform.Transform;

/**
 * The {@link Camera} allows projecting a 3d scene to a 2d screen based on an orthogonal or
 * perspective projection.
 * 
 * The 3d world part displayed on the 2d screen is defined by the following parameters which are
 * illustrated on the image below
 * <ul>
 * <li>{@link Camera#target} indicates the position of the point that the camera is currently
 * centering on.
 * <li>{@link Camera#eye} indicates the position of the lens of the camera.
 * <li>{@link Camera#up} indicates the direction of the top of the camera.
 * <li>{@link Camera#radius} indicates the width of the field of view when working with
 * {@link CameraMode#ORTHOGONAL} projections
 * <li>{@link Camera#near} defines the distance from which a 3d item is visible by camera.
 * <li>{@link Camera#far} defines the distance up to which a 3d item is visible by camera.
 * </ul>
 * 
 * <br>
 * <img src=
 * "data:image/png;base64,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"/>
 * <br>
 * 
 * All camera settings are in cartesian coordinates.
 * 
 * @author Martin Pernollet
 */
public class Camera extends AbstractViewportManager {
  private static final Logger LOGGER = Logger.getLogger(Camera.class);

  /** The polar default view point, i.e. Coord3d(Math.PI/3,Math.PI/5,500). */
  public static final Coord3d DEFAULT_VIEW = new Coord3d(Math.PI / 3, Math.PI / 5, 500);

  /**
   * Defines if camera distance is real, or only squared (squared distance avoid computing
   * Math.sqrt() and is thus faster). Second mode requires value true
   */
  public static final boolean DEFAULT_CAMERA_DISTANCE_MODE = true;

  /**
   * Defines if camera distance is real, or only squared (squared distance avoid computing
   * Math.sqrt() and is thus faster).
   */
  protected boolean useSquaredDistance = DEFAULT_CAMERA_DISTANCE_MODE;

  /** The camera viewpoint */
  protected Coord3d eye;
  /** The camera target */
  protected Coord3d target;
  /** The camera up vector */
  protected Coord3d up;
  /** The scale used to display elements */
  protected Coord3d scale;

  /** Predicate caching pre-computed data to quickly decide if a point is 'on the left'. */
  private Predicate<Coord3d> isOnLeftSide;

  /**
   * The rendering radius, used to automatically define with/height of scene and distance of
   * clipping planes.
   */
  protected float radius;
  /** The distance between the camera eye and the near clipping plane. */
  protected float near;
  /** The distance between the camera eye and the far clipping plane. */
  protected float far;

  /**
   * The configuration used to make orthogonal rendering.
   * 
   * @see glOrtho
   */
  protected Ortho ortho = new Ortho();

  /**
   * Set up a Camera looking at target, with a viewpoint standing at target+(0,0,100). The top of
   * the camera is set up toward the positive Z direction.
   */
  public Camera(Coord3d target) {
    initWithTarget(target);
  }

  public void initWithTarget(Coord3d initialTarget) {
    Coord3d initialEye = DEFAULT_VIEW.cartesian().add(initialTarget);
    Coord3d initialUp = new Coord3d(0, 0, 1);
    Coord3d initialScale = new Coord3d(1, 1, 1);
    setPosition(initialEye, initialTarget, initialUp, initialScale);

    setViewPort(1, 1, 0, 1);
    setRenderingDepth(0.5f, 100000f);
    setRenderingSphereRadius(1);
    setViewportMode(ViewportMode.RECTANGLE_NO_STRETCH);
  }

  public Camera() {
    this(Coord3d.ORIGIN.clone());
  }

  /******************************************************************/

  /**
   * Set the position of this camera's lens.
   * <p>
   * All other parameters of this camera remain unchanged. To change multiple parameters atomically
   * use {@link #setPosition(Coord3d, Coord3d, Coord3d, Coord3d)}.
   * </p>
   * 
   * @param eye the new <em>scaled</em> position of this camera's lens.
   */
  public void setEye(Coord3d eye) {
    setPosition(eye, target);
  }

  /** Returns the eye's position. */
  public Coord3d getEye() {
    return eye;
  }

  /**
   * Set the position of the target at which this camera is centering.
   * <p>
   * All other parameters of this camera remain unchanged. To change multiple parameters atomically
   * use {@link #setPosition(Coord3d, Coord3d, Coord3d, Coord3d)}.
   * </p>
   * 
   * @param target the new <em>scaled</em> position of this camera's target
   */
  public void setTarget(Coord3d target) {
    setPosition(eye, target);
  }

  /** Returns the target's position that was set at the last call to lookAt(). */
  public Coord3d getTarget() {
    return target;
  }

  /**
   * Set the up-direction of this camera.
   * <p>
   * All other parameters of this camera remain unchanged. To change multiple parameters atomically
   * use {@link #setPosition(Coord3d, Coord3d, Coord3d, Coord3d)}.
   * </p>
   * 
   * @param up the new up-direction of this camera
   */
  public void setUp(Coord3d up) {
    setPosition(eye, target, up, scale);
  }

  /** Returns the top of the camera. */
  public Coord3d getUp() {
    return this.up;
  }

  /** Returns the scale used by this camera to display elements. */
  public Coord3d getScale() {
    return scale;
  }

  /**
   * Set the camera's eye- and target-location.
   * <p>
   * All other parameters of this camera remain unchanged. To change more parameters atomically use
   * {@link #setPosition(Coord3d, Coord3d, Coord3d, Coord3d)}.
   * </p>
   * 
   * @param eye
   * @param target
   */
  public void setPosition(Coord3d eye, Coord3d target) {
    setPosition(eye, target, up, scale);
  }

  /**
   * Atomically sets this camera's eye- and target-position, its up-direction and the scale with
   * which data are displayed.
   *
   * @param eye the scaled location of the camera eye (previously multiplied with this camera's
   *        scale)
   * @param target the scaled location at which this camera will look (previously multiplied with
   *        this camera's scale)
   * @param up the direction of the up-side of this camera (not scaled)
   * @param scale the scale used by this camera to display elements
   */
  public void setPosition(Coord3d eye, Coord3d target, Coord3d up, Coord3d scale) {
    this.eye = eye;
    this.target = target;
    this.up = up;
    this.scale = scale;
    this.isOnLeftSide = null; // trigger full re-computation of all data for side-computation
  }

  /**
   * Returns true if the camera is 'looking up', in other word if the eye's Z value is inferior to
   * the target's Z value.
   */
  public boolean isTiltUp() {
    return eye.z < target.z;
  }

  /**
   * Set the radius of the sphere that will be contained into the rendered view. The "far" and
   * "near" clipping planes are modified according to the eye-target distance.
   */
  public void setRenderingSphereRadius(float radius) {
    this.radius = radius;
    this.near = (float) eye.distance(target) - radius * 2;
    this.far = (float) eye.distance(target) + radius * 2;
  }

  /**
   * Return the radius of the sphere that will be contained into the rendered view.
   */
  public float getRenderingSphereRadius() {
    return radius;
  }

  /**
   * Manually set the rendering depth (near and far clipping planes). Note that
   * {@link Camera.setRenderingSphereRadius} modified the "far" clipping plane.
   */
  public void setRenderingDepth(float near, float far) {
    this.near = near;
    this.far = far;
  }

  /** Return the position of the "near" clipping plane */
  public float getNear() {
    return near;
  }

  /** Return the position of the "far" clipping plane */
  public float getFar() {
    return far;
  }

  /**
   * Return true if the given (not scaled) point is on the left of the plane built by the
   * eye->target and up-direction vector, else false.
   *
   * @param point not scaled point (its values correspond to a point in the scene)
   * @return true if the given point is 'on the left side' of this camera
   */
  public boolean side(Coord3d point) {
    // Compute the sign of the triple product of eye-to-point-direction, up-direction and
    // eye-to-target-direction (all not scaled). The given point is left of this camera's view-plane
    // build by eye-to-target-vector and the up-direction, if the following inequation holds
    // <e-p> * (<up> x <e-t>) > 0
    if (isOnLeftSide == null) {
      // Pre-compute and capture the required data in a Predicate to quickly decide (without
      // creating objects) if a point is on the left of the current camera position.

      Coord3d e = eye.div(scale); // un-scaled eye vector
      Coord3d viewDirectionU = target.sub(eye).div(scale).normalizeTo(1f);
      // Left pointing normal vector of the view-plane build by the eye->target-vector and the
      // up-direction (effectivly the cross product of up-direction and eye-target-vector).
      // Not scaled but normalized to length one for numerical stability.
      Coord3d vpn = up.getNormalizedTo(1f).cross(viewDirectionU); // view-plane normal

      isOnLeftSide = p -> 0 < (p.x - e.x) * vpn.x + (p.y - e.y) * vpn.y + (p.z - e.z) * vpn.z;
      // equivalent to: 0 < p.sub(e).dot(vpn)
    }
    return this.isOnLeftSide.test(point);
  }

  /** Return last values used to make orthogonal scene rendering. Do not edit. */
  public Ortho getOrtho() {
    return ortho;
  }

  /************************** PROJECT / UNPROJECT ****************************/

  /**
   * Transform a 2d screen coordinate into a 3d coordinate. The z component of the screen coordinate
   * indicates a depth value between the near and far clipping plane of the {@link Camera}.
   * 
   * @throws a RuntimeException if an error occured while trying to retrieve model coordinates
   */
  public Coord3d screenToModel(IPainter painter, Coord3d screen) {
    int viewport[] = painter.getViewPortAsInt();
    float modelView[] = painter.getModelViewAsFloat();
    float projection[] = painter.getProjectionAsFloat();
    float worldcoord[] = new float[3];// wx, wy, wz;// returned xyz coords

    boolean s = painter.gluUnProject(screen.x, screen.y, screen.z, modelView, 0, projection, 0,
        viewport, 0, worldcoord, 0);
    if (!s)
      failedProjection("Could not retrieve screen coordinates in model.");

    return new Coord3d(worldcoord[0], worldcoord[1], worldcoord[2]);
  }

  /**
   * Transform a 3d point coordinate into its screen position.
   * 
   * This method requires the GL context to be current. If not called inside a rendering loop, that
   * method may not apply correctly and output {0,0,0}. In that case and if the chart is based on
   * JOGL (native), one may force the context to be current using
   * 
   * <pre>
   * <code>
   * NativeDesktopPainter p = (NativeDesktopPainter)chart.getPainter();
   * p.getCurrentContext(chart.getCanvas()).makeCurrent(); // make context current
   * 
   * Coord3d screen2dCoord = camera.modelToScreen(chart.getPainter(), world3dCoord);
   * 
   * p.getCurrentContext(chart.getCanvas()).release(); // release context to let other use it
   * </code>
   * </pre>
   * 
   * @throws a RuntimeException if an error occured while trying to retrieve model coordinates AND
   *         if {@link #failOnException} is set to true (default is false). In case
   *         {@link #failOnException} is false, a DEBUG log is sent to the {@link #LOGGER}.
   */
  public Coord3d modelToScreen(IPainter painter, Coord3d point) {
    int viewport[] = painter.getViewPortAsInt();

    float screenCoord[] = new float[3];// wx, wy, wz;// returned xyz coords

    if (!painter.gluProject(point.x, point.y, point.z, painter.getModelViewAsFloat(), 0,
        painter.getProjectionAsFloat(), 0, viewport, 0, screenCoord, 0))
      failedProjection("Could not retrieve model coordinates in screen for " + point);
    return new Coord3d(screenCoord[0], screenCoord[1], screenCoord[2]);
  }

  public Coord3d[] modelToScreen(IPainter painter, Coord3d[] points) {
    int viewport[] = painter.getViewPortAsInt();

    float screenCoord[] = new float[3];

    Coord3d[] projection = new Coord3d[points.length];

    for (int i = 0; i < points.length; i++) {
      if (!painter.gluProject(points[i].x, points[i].y, points[i].z, painter.getModelViewAsFloat(),
          0, painter.getProjectionAsFloat(), 0, viewport, 0, screenCoord, 0))
        failedProjection("Could not retrieve model coordinates in screen for " + points[i]);
      projection[i] = new Coord3d(screenCoord[0], screenCoord[1], screenCoord[2]);
    }
    return projection;
  }

  public Coord3d[][] modelToScreen(IPainter painter, Coord3d[][] points) {
    int viewport[] = painter.getViewPortAsInt();

    float screenCoord[] = new float[3];

    Coord3d[][] projection = new Coord3d[points.length][points[0].length];

    for (int i = 0; i < points.length; i++) {
      for (int j = 0; j < points[i].length; j++) {
        if (!painter.gluProject(points[i][j].x, points[i][j].y, points[i][j].z,
            painter.getModelViewAsFloat(), 0, painter.getProjectionAsFloat(), 0, viewport, 0,
            screenCoord, 0))
          failedProjection("Could not retrieve model coordinates in screen for " + points[i][j]);
        projection[i][j] = new Coord3d(screenCoord[0], screenCoord[1], screenCoord[2]);
      }
    }
    return projection;
  }

  public List<Coord3d> modelToScreen(IPainter painter, List<Coord3d> points) {
    int viewport[] = painter.getViewPortAsInt();

    float screenCoord[] = new float[3];

    List<Coord3d> projection = new Vector<Coord3d>();

    for (Coord3d point : points) {
      if (!painter.gluProject(point.x, point.y, point.z, painter.getModelViewAsFloat(), 0,
          painter.getProjectionAsFloat(), 0, viewport, 0, screenCoord, 0))
        failedProjection("Could not retrieve model coordinates in screen for " + point);
      projection.add(new Coord3d(screenCoord[0], screenCoord[1], screenCoord[2]));
    }
    return projection;
  }

  public ArrayList<ArrayList<Coord3d>> modelToScreen(IPainter painter,
      ArrayList<ArrayList<Coord3d>> polygons) {
    int viewport[] = painter.getViewPortAsInt();

    float screenCoord[] = new float[3];

    ArrayList<ArrayList<Coord3d>> projections = new ArrayList<ArrayList<Coord3d>>(polygons.size());

    for (ArrayList<Coord3d> polygon : polygons) {
      ArrayList<Coord3d> projection = new ArrayList<Coord3d>(polygon.size());
      for (Coord3d point : polygon) {
        if (!painter.gluProject(point.x, point.y, point.z, painter.getModelViewAsFloat(), 0,
            painter.getProjectionAsFloat(), 0, viewport, 0, screenCoord, 0))
          failedProjection("Could not retrieve model coordinates in screen for " + point);
        projection.add(new Coord3d(screenCoord[0], screenCoord[1], screenCoord[2]));
      }
      projections.add(projection);
    }
    return projections;
  }

  public PolygonArray modelToScreen(IPainter painter, PolygonArray polygon) {
    int viewport[] = painter.getViewPortAsInt();

    float screenCoord[] = new float[3];

    int len = polygon.length();

    float[] x = new float[len];
    float[] y = new float[len];
    float[] z = new float[len];

    for (int i = 0; i < len; i++) {
      if (!painter.gluProject(polygon.x[i], polygon.y[i], polygon.z[i],
          painter.getModelViewAsFloat(), 0, painter.getProjectionAsFloat(), 0, viewport, 0,
          screenCoord, 0))
        failedProjection("Could not retrieve model coordinates in screen for point " + i);
      x[i] = screenCoord[0];
      y[i] = screenCoord[1];
      z[i] = screenCoord[2];
    }
    return new PolygonArray(x, y, z);
  }

  public PolygonArray[][] modelToScreen(IPainter painter, PolygonArray[][] polygons) {
    int viewport[] = painter.getViewPortAsInt();
    float screencoord[] = new float[3];

    PolygonArray[][] projections = new PolygonArray[polygons.length][polygons[0].length];
    for (int i = 0; i < polygons.length; i++) {
      for (int j = 0; j < polygons[i].length; j++) {
        PolygonArray polygon = polygons[i][j];
        int len = polygon.length();
        float[] x = new float[len];
        float[] y = new float[len];
        float[] z = new float[len];

        for (int k = 0; k < len; k++) {
          if (!painter.gluProject(polygon.x[k], polygon.y[k], polygon.z[k],
              painter.getModelViewAsFloat(), 0, painter.getProjectionAsFloat(), 0, viewport, 0,
              screencoord, 0))
            failedProjection("Could not retrieve model coordinates in screen for point " + k);
          x[k] = screencoord[0];
          y[k] = screencoord[1];
          z[k] = screencoord[2];
        }
        projections[i][j] = new PolygonArray(x, y, z);
      }
    }
    return projections;
  }

  protected void failedProjection(String message) {
    if (failOnException)
      throw new RuntimeException(message);
    else
      LOGGER.debug(message);
  }

  boolean failOnException = false;

  /*******************************************************************/

  public void show(IPainter painter, Transform transform, Coord3d scaling) {
    if (transform != null)
      transform.execute(painter);

    Coord3d eye = getEye().mul(scaling);

    painter.glBegin_Point();
    painter.glPointSize(camWidth);
    painter.glColor4f(camColor.r, camColor.g, camColor.b, camColor.a);
    painter.glVertex3f(eye.x, eye.y, eye.z);
    painter.glEnd();

  }

  Color camColor = Color.BLACK;
  int camWidth = 3;

  /* */

  /**
   * Sets the projection and the mapping of the 3d model to 2d screen. The projection must be either
   * Camera.PERSPECTIVE or Camera.ORTHOGONAL. <br>
   * shoot() finally calls the GL function glLookAt, according to the stored eye, target, up and
   * scale values. <br>
   * Note that the Camera set by itselft the MatrixMode to model view at the end of a shoot(). <br>
   * 
   * @param painter TODO
   * @param projection the projection mode.
   * @throws a Runtime Exception if the projection mode is neither Camera.PERSPECTIVE nor
   *         Camera.ORTHOGONAL.
   */
  public void shoot(IPainter painter, CameraMode projection) {
    shoot(painter, projection, false);
  }

  public void shoot(IPainter painter, CameraMode projection, boolean doPushMatrixBeforeShooting) {
    painter.glMatrixMode_Projection();

    if (doPushMatrixBeforeShooting)
      painter.glPushMatrix();

    painter.glLoadIdentity();

    doShoot(painter, projection);
  }

  public void doShoot(IPainter painter, CameraMode projection) {
    // Set viewport
    ViewportConfiguration viewport = applyViewport(painter);

    // Set projection
    if (projection == CameraMode.PERSPECTIVE) {
      projectionPerspective(painter, viewport);
    } else if (projection == CameraMode.ORTHOGONAL) {
      projectionOrtho(painter, viewport);
    } else
      throw new RuntimeException("Camera.shoot(): unknown projection mode '" + projection + "'");

    // Set camera position
    doLookAt(painter);
  }

  /**
   * Perform a perspective projection by processing the field of view based on the {@link #radius},
   * {@link #target} and {@link #eye}.
   * 
   * <br>
   * <img src=
   * "data:image/gif;base64,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"/>
   * 
   * @param painter
   * @param viewport
   */
  protected void projectionPerspective(IPainter painter, ViewportConfiguration viewport) {
    boolean stretchToFill = ViewportMode.STRETCH_TO_FILL.equals(viewport.getMode());
    double fov = computeFieldOfView(radius * 2, eye.distance(target));
    float aspect = stretchToFill ? ((float) screenWidth) / ((float) screenHeight) : 1;
    float nearCorrected = near <= 0 ? 0.000000000000000000000000000000000000001f : near;

    painter.gluPerspective(fov / 1, aspect * 0.55, nearCorrected, far);

    // painter.glFrustum(-radius*3, radius*3, -radius*3, radius*3, near, far);
  }

  protected void doLookAt(IPainter painter) {
    painter.gluLookAt(eye.x, eye.y, eye.z, target.x, target.y, target.z, up.x, up.y, up.z);
  }

  /**
   * Perform a orthogonal projection.
   * 
   * The viewable part of the 3d scene is defined by parameters {left, right, bottom, top, near,
   * far} which are processed according to the {@link ViewportMode} and the values of the camera
   * settings ({@link #radius}, {@link #target} and {@link #eye}, {@link #near} and {@link #far}
   * clipping planes).
   * 
   * <br>
   * <img src=
   * "data:image/gif;base64,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"/>
   * 
   * @param painter
   * @param viewport
   */
  protected void projectionOrtho(IPainter painter, ViewportConfiguration viewport) {
    if (ViewportMode.STRETCH_TO_FILL.equals(viewport.getMode())) {
      ortho.update(-radius, +radius, -radius, +radius, near, far);
    } else if (ViewportMode.RECTANGLE_NO_STRETCH.equals(viewport.getMode())) {
      ortho.update(-radius * viewport.ratio(), +radius * viewport.ratio(), -radius, +radius, near,
          far);
    } else if (ViewportMode.SQUARE.equals(viewport.getMode())) {
      ortho.update(-radius, +radius, -radius, +radius, near, far);
    }

    ortho.apply(painter);
  }

  /**
   * Compute the field of View, in order to occupy the entire screen in PERSPECTIVE mode.
   */
  protected double computeFieldOfView(double size, double distance) {
    double radianTheta = 2.0 * Math.atan2(size / 2.0, distance);
    return (180.0 * radianTheta) / Math.PI;
  }

  /**
   * Return the distance between the camera eye and the given drawable's barycenter.
   */
  public double getDistance(Drawable drawable) {
    if (useSquaredDistance)
      return drawable.getBarycentre().distanceSq(getEye());
    else
      return drawable.getBarycentre().distance(getEye());
  }

  /**
   * Apply scaling before computing distance between the camera eye and the given drawable's
   * barycenter.
   */
  public double getDistance(Drawable drawable, Coord3d viewScale) {
    if (useSquaredDistance)
      return drawable.getBarycentre().distanceSq(getEye().div(viewScale));
    else
      return drawable.getBarycentre().distance(getEye().div(viewScale));
  }

  /**
   * Return the distance between the camera eye and the given coordinate.
   */
  public double getDistance(Coord3d coord) {
    if (useSquaredDistance)
      return coord.distanceSq(getEye());
    else
      return coord.distance(getEye());
  }

  /**
   * Apply scaling before computing distance between the camera eye and the given coordinate.
   */
  public double getDistance(Coord3d coord, Coord3d viewScale) {
    if (useSquaredDistance)
      return coord.distanceSq(getEye().div(viewScale));
    else
      return coord.distance(getEye().div(viewScale));
  }

  public boolean isUseSquaredDistance() {
    return useSquaredDistance;
  }

  /**
   * Defines what getDistance(...) will return, either:
   * <ul>
   * <li>Squared distance (faster to compute since no Math.sqrt(...) at the end)
   * <li>Real distance
   * </ul>
   * 
   * Default value is set to true, meaning it use the faster squared distance.
   */
  public void setUseSquaredDistance(boolean useSquaredDistance) {
    this.useSquaredDistance = useSquaredDistance;
  }

  /* */

  /**
   * Print out in console information concerning the camera.
   */
  @Override
  public String toString() {
    return toString(eye, target, up);
  }

  protected String toString(Coord3d eye, Coord3d target, Coord3d up) {
    String output = "(Camera)";
    output += (" lookFrom  = {" + eye.x + ", " + eye.y + ", " + eye.z + "}");
    output += (" lookTo    = {" + target.x + ", " + target.y + ", " + target.z + "}");
    output += (" topToward = {" + up.x + ", " + up.y + ", " + up.z + "}");
    return output;
  }

  /**
   * The configuration used to call glOrtho
   * 
   */
  public static class Ortho {
    /** the latest value used to invoke glOrtho */
    public double left;
    /** the latest value used to invoke glOrtho */
    public double right;
    /** the latest value used to invoke glOrtho */
    public double bottom;
    /** the latest value used to invoke glOrtho */
    public double top;
    /** the latest value used to invoke glOrtho */
    public double near;
    /** the latest value used to invoke glOrtho */
    public double far;

    public Ortho() {}

    public void update(double left, double right, double bottom, double top, double near,
        double far) {
      this.left = left;
      this.right = right;
      this.bottom = bottom;
      this.top = top;
      this.near = near;
      this.far = far;
    }

    /**
     * Applies orthogonal projection only if parameters are valid (i.e. not zero)
     */
    public void apply(IPainter painter) {
      if (left != 0 && right != 0 && bottom != 0 && top != 0 && near != 0 && far != 0) {
        painter.glOrtho(left, right, bottom, top, near, far);
      }
    }

    @Override
    public String toString() {
      return "left:" + left + " right:" + right + " bottom:" + bottom + " top:" + top + " near:"
          + near + " far:" + far;
    }
  }
}
